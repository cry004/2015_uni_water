var FacebookUtil=FacebookUtil||{};!function(){FacebookUtil={uid:"",accessToken:"",appId:"",xfbml:!0,status:!0,cookie:!0,oauth:!0,channelUrl:"",scope:"",connected:"",me:{},init:function(a){FacebookUtil.channelUrl=window.location.protocol+"//"+window.location.hostname+"/channel.html",window.fbAsyncInit=function(){0==$("#fb-root").length&&$("body").prepend('<div id="fb-root"></div>'),FB.init({appId:FacebookUtil.appId,xfbml:FacebookUtil.xfbml,status:FacebookUtil.status,cookie:FacebookUtil.cookie,oauth:FacebookUtil.oauth,version:"v2.0"}),FB.getLoginStatus(function(b){FacebookUtil.updateStatus(b),"function"==typeof a&&a()}),FB.Event.subscribe("auth.statusChange",FacebookUtil.updateStatus),FB.Event.subscribe("edge.create",function(a){"function"==typeof FacebookUtil.edgeCreateEvent&&FacebookUtil.edgeCreateEvent(a)})},function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_US/sdk.js",e.parentNode.insertBefore(d,e))}(document,"script","facebook-jssdk")},updateStatus:function(a){a?(FacebookUtil.connected=a.status,a.authResponse&&(FacebookUtil.uid=a.authResponse.userID,FacebookUtil.accessToken=a.authResponse.accessToken),console.log("uid: "+FacebookUtil.uid)):FB.getLoginStatus(FacebookUtil.updateStatus)},edgeCreateEvent:null,setSize:function(a,b){window.parent&&(a&&b?FB.Canvas.setSize({width:a,height:b}):FB.Canvas.setSize())},login:function(a,b){"connected"==FacebookUtil.connected?"function"==typeof a&&FacebookUtil.getMe(function(b){a(b)}):FB.login(function(c){c.authResponse?(FacebookUtil.uid=c.authResponse.userID,FacebookUtil.accessToken=c.authResponse.accessToken,FacebookUtil.connected=c.status,"function"==typeof a&&FacebookUtil.getMe(function(b){a(b)})):"function"==typeof b?b(c):(console.log("FacebookUtil: login failed==="),console.log(c))},{scope:FacebookUtil.scope})},api:function(a,b,c,d,e){b||(b="get"),FB.api(a,b,c,function(a){!a||a.error?"function"==typeof e&&e(a):"function"==typeof d&&d(a)})},ui:function(a,b,c){FB.ui(a,function(a){!a||a.error?"function"==typeof c&&c(a):"function"==typeof b&&b(a)})},fql:function(a,b){FB.api({method:"fql.query",query:a,nc:(new Date).getTime()},function(a){"function"==typeof b&&b(a)})},getMe:function(a,b){FacebookUtil.api("/me","get",null,function(c){c?(FacebookUtil.me=c,"function"==typeof a&&a(c)):"function"==typeof b&&b()})},getFriends:function(a,b){FacebookUtil.api("/me/friends/","get",{limit:0,fields:"name,id,picture"},function(c){var d=[];c?(d=c.data,"function"==typeof a&&a(d)):"function"==typeof b&&b()})},getAlbums:function(a,b){FacebookUtil.api("/me/albums/","get",{limit:100,fields:"id,cover_photo,name"},function(c){var d=[];c?(d=c.data,"function"==typeof a&&a(d)):"function"==typeof b&&b()})},getPhotosByAlbumId:function(a,b,c){FacebookUtil.api("/"+a+"/photos","get",{limit:300,fields:"id,name,picture,source"},function(a){var d=[];a?(d=a.data,"function"==typeof b&&b(d)):"function"==typeof c&&c()})},createAlbum:function(a,b,c,d){FacebookUtil.api("/me/albums","post",{name:a,message:b},function(a){a?"function"==typeof c&&c(a.id):"function"==typeof d&&d()})},chkIsAlbumExistByName:function(a,b){FacebookUtil.getAlbums(function(c){for(var d="",e=0;e<c.length;e++)if(c[e].name.indexOf(a)>=0){d=c[e].id;break}"function"==typeof b&&b(d)})},isFans:function(a,b,c){var d="select uid from page_fan where uid = me() and page_id = "+a;FacebookUtil.fql(d,function(a){a?"function"==typeof b&&b(a.length>0?!0:!1):"function"==typeof c&&c()})},feedUI:function(a,b,c){a.method="feed",FacebookUtil.ui(a,function(a){"function"==typeof b&&b(a?!0:!1)},function(){"function"==typeof c&&c()})},feed:function(a,b,c){FacebookUtil.api("/me/feed","post",a,function(a){"function"==typeof b&&b(a?!0:!1)},function(){"function"==typeof c&&c()})},uploadPhoto:function(a,b,c,d,e){var f={url:a,message:b};""==c&&(c="me"),console.log("pAlbumId: "+c),FacebookUtil.api("/"+c+"/photos","post",f,function(a){a.id?"function"==typeof d&&d():"function"==typeof e&&e()},function(){"function"==typeof e&&e()})}}}();